<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crime Investigation Game: The Midnight Mystery</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Crimson+Pro:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* All your existing CSS remains exactly the same */
        :root {
            --dark-bg: #1a1a2e;
            --darker-bg: #16213e;
            --card-bg: #0f3460;
            --accent: #e94560;
            --accent-hover: #ff6b81;
            --text: #e0e0e0;
            --text-muted: #a0a0a0;
            --success: #4caf50;
            --danger: #f44336;
            --warning: #ff9800;
            --evidence: #2196f3;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--dark-bg);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(15, 52, 96, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(233, 69, 96, 0.1) 0%, transparent 20%);
            min-height: 100vh;
        }
        
        .game-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: var(--darker-bg);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            border-bottom: 3px solid var(--accent);
            position: relative;
        }
        
        .detective-badge {
            position: absolute;
            top: 20px;
            left: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(233, 69, 96, 0.1);
            padding: 10px 15px;
            border-radius: 20px;
            border: 1px solid var(--accent);
        }
        
        .detective-badge img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid var(--accent);
        }
        
        h1 {
            font-family: 'Crimson Pro', serif;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 10px;
            font-size: 2.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .tagline {
            font-style: italic;
            color: var(--text-muted);
            font-size: 1.1rem;
        }
        
        .intro {
            background-color: var(--darker-bg);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            border-left: 4px solid var(--accent);
        }
        
        .intro h2 {
            color: var(--accent);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Crimson Pro', serif;
        }
        
        .intro h2::before {
            content: "üïµÔ∏è‚Äç‚ôÄÔ∏è";
            font-size: 1.5rem;
        }
        
        .case-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .case-detail-item {
            background: rgba(233, 69, 96, 0.1);
            padding: 12px 15px;
            border-radius: 6px;
            border-left: 3px solid var(--accent);
        }
        
        .case-detail-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }
        
        .case-detail-value {
            font-weight: 500;
            color: var(--accent);
        }
        
        .container {
            display: flex;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .sidebar {
            flex: 0 0 300px;
            background-color: var(--darker-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            height: fit-content;
        }
        
        .sidebar h2 {
            text-align: center;
            color: var(--accent);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-family: 'Crimson Pro', serif;
        }
        
        .suspect-list {
            list-style: none;
        }
        
        .suspect-item {
            background-color: var(--card-bg);
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            border-left: 3px solid transparent;
        }
        
        .suspect-item:hover {
            background-color: rgba(233, 69, 96, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .suspect-item.active {
            background-color: rgba(233, 69, 96, 0.15);
            border-left: 3px solid var(--accent);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .suspect-item img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid var(--accent);
            object-fit: cover;
        }
        
        .suspect-info {
            flex: 1;
        }
        
        .suspect-name {
            font-weight: 700;
            margin-bottom: 5px;
            font-family: 'Crimson Pro', serif;
        }
        
        .suspect-relationship {
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        .main-panel {
            flex: 1;
            background-color: var(--darker-bg);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
        }
        
        .suspect-details {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .suspect-header {
            display: flex;
            align-items: center;
            gap: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .suspect-portrait {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 4px solid var(--accent);
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }
        
        .suspect-bio {
            flex: 1;
        }
        
        .suspect-name-large {
            font-size: 2.2rem;
            color: var(--accent);
            font-family: 'Crimson Pro', serif;
            margin-bottom: 10px;
        }
        
        .suspect-description {
            color: var(--text-muted);
            line-height: 1.7;
        }
        
        .motive-section, .alibi-section, .evidence-section {
            padding: 20px;
            background-color: var(--card-bg);
            border-radius: 8px;
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--accent);
            font-weight: 600;
            font-family: 'Crimson Pro', serif;
        }
        
        .motive-text, .alibi-text {
            line-height: 1.7;
            position: relative;
            padding-left: 20px;
        }
        
        .alibi-text::before {
            content: "‚Äú";
            font-size: 3rem;
            position: absolute;
            left: -5px;
            top: -15px;
            color: rgba(233, 69, 96, 0.3);
        }
        
        .evidence-list {
            list-style: none;
            margin-top: 15px;
        }
        
        .evidence-item {
            padding: 12px 15px;
            margin-bottom: 10px;
            background-color: rgba(33, 150, 243, 0.1);
            border-radius: 6px;
            border-left: 3px solid var(--evidence);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .evidence-item::before {
            content: "üîç";
            font-size: 1.2rem;
        }
        
        .speaker {
            cursor: pointer;
            font-size: 1.5rem;
            margin-left: 10px;
            color: var(--accent);
            transition: transform 0.2s;
        }
        
        .speaker:hover {
            transform: scale(1.2);
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
        }
        
        button {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
        }
        
        button:hover {
            background-color: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button.accuse {
            background-color: var(--danger);
        }
        
        button.accuse:hover {
            background-color: #e53935;
        }
        
        .result {
            display: none;
            background-color: var(--darker-bg);
            padding: 30px;
            border-radius: 10px;
            margin-top: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }
        
        .result h2 {
            color: var(--accent);
            margin-bottom: 20px;
            font-family: 'Crimson Pro', serif;
        }
        
        .verdict {
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .correct {
            background-color: rgba(76, 175, 80, 0.1);
            border-left: 4px solid var(--success);
        }
        
        .incorrect {
            background-color: rgba(244, 67, 54, 0.1);
            border-left: 4px solid var(--danger);
        }
        
        .killer-reveal {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid var(--warning);
        }
        
        .analysis {
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(233, 69, 96, 0.1);
            border-radius: 8px;
        }
        
        .analysis h3 {
            color: var(--accent);
            margin-bottom: 15px;
            font-family: 'Crimson Pro', serif;
        }
        
        .clue-highlight {
            background-color: rgba(255, 152, 0, 0.2);
            padding: 3px 6px;
            border-radius: 3px;
            font-weight: 500;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
        }
        
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                flex: none;
                width: 100%;
            }
            
            .suspect-header {
                flex-direction: column;
                text-align: center;
            }
            
            .detective-badge {
                position: relative;
                top: 0;
                left: 0;
                justify-content: center;
                margin-bottom: 15px;
            }
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .suspect-portrait {
                width: 120px;
                height: 120px;
            }
            
            .action-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
            
            .case-details {
                grid-template-columns: 1fr;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .notes-panel {
            margin-top: 20px;
            padding: 15px;
            background-color: var(--card-bg);
            border-radius: 8px;
            border: 1px dashed rgba(255, 255, 255, 0.2);
        }
        
        .notes-panel h3 {
            color: var(--accent);
            margin-bottom: 10px;
            font-family: 'Crimson Pro', serif;
        }
        
        #detective-notes {
            width: 100%;
            height: 100px;
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            padding: 10px;
            color: var(--text);
            font-family: 'Roboto', sans-serif;
            resize: vertical;
        }
        
        .difficulty-indicator {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-left: 10px;
            background-color: rgba(233, 69, 96, 0.2);
            color: var(--accent);
        }

        .voice-loading {
            display: none;
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <header>
            <div class="detective-badge">
                <img style="object-fit: fit;" src="images/abbyyy.jpg" alt="Detective Abby">
                <div style="text-align: left !important;">
                    <strong >Abby</strong>
                    <div style="font-size: 0.8rem; color: var(--text-muted);">Homicide Division</div>
                </div>
            </div>
            <h1>The Midnight Mystery</h1>
            <p class="tagline">Can you identify the killer through careful deduction?</p>
        </header>
        
        <div class="intro" id="intro">
            <!-- Intro will be populated by JS -->
        </div>
        
        <div class="container">
            <div class="sidebar">
                <h2>Suspects <span class="difficulty-indicator">Analyze All</span></h2>
                <ul class="suspect-list" id="suspect-list">
                    <!-- Suspects will be populated by JS -->
                </ul>
            </div>
            <div class="main-panel" id="main-panel">
                <div class="suspect-details">
                    <div class="suspect-header">
                        <img src="https://images.unsplash.com/photo-1560250097-0b93528c311a?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80" alt="Select a suspect" class="suspect-portrait">
                        <div class="suspect-bio">
                            <h2 class="suspect-name-large">Select a Suspect</h2>
                            <p class="suspect-description">Click on a suspect from the list to investigate their background, motive, alibi, and evidence. Analyze all information carefully before making an accusation.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="notes-panel">
            <h3>Abby's Notes</h3>
            <textarea id="detective-notes" placeholder="Record your observations, contradictions, and theories here..."></textarea>
        </div>
        
        <div class="result" id="result">
            <h2 id="accused-title">Investigation Result</h2>
            <div class="verdict" id="verdict">
                <!-- Verdict will be populated by JS -->
            </div>
            <div class="analysis" id="analysis">
                <!-- Analysis will be populated by JS -->
            </div>
            <div class="killer-reveal">
                <h2 id="killer-reveal-title">The Real Killer</h2>
                <p id="killer-reveal"></p>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="cases-solved">0</div>
                    <div class="stat-label">Cases Solved</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="accuracy">0%</div>
                    <div class="stat-label">Accuracy</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="current-streak">0</div>
                    <div class="stat-label">Current Streak</div>
                </div>
            </div>
            <div class="action-buttons" style="margin-top: 25px;">
                <button id="play-again" style="display: none;">
                    <span>üîÑ</span> Play Again
                </button>
                <button id="next-case" style="display: none;">
                    <span>üîç</span> Next Case
                </button>
            </div>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            casesSolved: parseInt(localStorage.getItem('casesSolved')) || 0,
            casesPlayed: parseInt(localStorage.getItem('casesPlayed')) || 0,
            currentStreak: parseInt(localStorage.getItem('currentStreak')) || 0,
            bestStreak: parseInt(localStorage.getItem('bestStreak')) || 0
        };

        // Define multiple crime scenarios
        const scenarios = [
            {
                id: 1,
                title: "The Poisoned Mogul",
                victim: "Mr. Victor Reyes",
                victimAge: "65",
                victimOccupation: "Real Estate Mogul",
                crimeScene: "his upscale suburban home",
                causeOfDeath: "poisoning via a spiked drink",
                timeOfDeath: "9:15 PM",
                intro: "Welcome, Abby! Mr. Victor Reyes, a 65-year-old real estate mogul, was found dead in his upscale suburban home last night. The autopsy reveals he was poisoned via a spiked drink during a tense family dinner. Time of death is estimated at 9:15 PM. There are multiple motives among the suspects‚Äîinheritance from his $50 million estate, business rivalries, and personal betrayals. Your sidekicks‚ÄîHomer Acuna (tech expert), Angel Ochoa (forensic analyst), Moises (interrogator), Tony (surveillance guy), Cath (psychologist), and Ellaine (historian)‚Äîhave gathered clues. Click a suspect to view their alibi and clue. Accuse wisely!",
                killerReveals: [
                    "Mikay's alibi was contradicted by the library's digital records system which showed no checkouts after 7 PM. Additionally, the book she claimed to have borrowed wasn't in the library's inventory that day. Forensic analysis matched the poison to chemicals from her laboratory.",
                    "Josh's alibi fell apart when security footage from the building across from his 'business meeting' location showed his car parked there from 9:45 PM to 11:20 PM. His fingerprints were also found on the poisoned glass.",
                    "Jomar's claim of being at the gym was disproven by the facility's biometric scanners which showed he left at 8:05 PM. Traces of the poison were found on his work gloves.",
                    "Zette's computer logs showed her account was active but with no keystroke activity between 8:40-9:15 PM. Security logs show her keycard was used at Victor's house at 8:50 PM.",
                    "MJ's event photos show him present at 7:30 PM and 11:00 PM but none between 8:45-10:15 PM. Phone location data placed him near the crime scene at 9:10 PM.",
                    "Louis's streaming service shows the movie was paused at 8:42 PM and not resumed until 9:28 PM. Cell tower data shows his phone connected to a tower near Victor's house at 9:05 PM.",
                    "Kassandra's sister's security system shows no one entered or exited the house during the time Kassandra claimed to be there. Her distinctive earring was found near the crime scene.",
                    "Jay's hotel check-in records show he arrived at 6:15 PM but no keycard activity until 10:30 PM. Toll records show his car passing back into the city at 8:20 PM."
                ]
            },
            {
                id: 2,
                title: "The Strangled CEO",
                victim: "Mrs. Elena Vargas",
                victimAge: "58",
                victimOccupation: "Tech CEO",
                crimeScene: "her high-rise apartment",
                causeOfDeath: "strangulation",
                timeOfDeath: "10:30 PM",
                intro: "Welcome, Detective Abby! Mrs. Elena Vargas, a 58-year-old tech CEO, was discovered strangled in her high-rise apartment. The nature of the strangulation marks suggests the killer was a close acquaintance. Time of death is estimated at 10:30 PM. Suspects are her ambitious heirs and business partners, driven by greed and revenge. Your team has evidence. Investigate!",
                killerReveals: [
                    "Mikay's security badge logs show she entered the building at 9:45 PM but didn't exit until 11:15 PM. Fibers from her scarf were found at the crime scene.",
                    "Josh's business dinner was actually scheduled for the following night according to the hotel's event calendar. His DNA was found under Elena's fingernails.",
                    "Jomar's fitness tracker data shows he was stationary for 45 minutes during his supposed workout, and his location was near Elena's apartment building.",
                    "Zette's keycard was used to access Elena's floor at 10:15 PM, and security footage shows her leaving in a hurry at 10:45 PM.",
                    "MJ's charity gala had a strict no-reentry policy, and security records show he exited at 9:40 PM. His cufflink was found at the crime scene.",
                    "Louis's home security system logged the front door opening at 10:10 PM and closing at 10:50 PM. His fingerprints were found on a broken vase near the body.",
                    "Kassandra's neighbor reported hearing a loud argument from her apartment at 10:15 PM, and her car was seen leaving the parking garage at 10:35 PM.",
                    "Jay's conference badge was not scanned at any sessions after 4 PM, and his rental car was recorded entering Elena's building garage at 10:05 PM."
                ]
            }
        ];

        // All 8 original suspects with UNIQUE NATURAL VOICES
        const suspectsData = [
            // GIRLS - Each with unique female voice
            {
                name: "Mikay",
                image: "images/mikay.jpg",
                voice: { 
                    // Young, intelligent female voice
                    rate: 0.95,
                    pitch: 1.15,
                    volume: 1.0,
                    lang: 'en-US',
                    gender: 'female'
                },
                relationships: ["Daughter", "Business Partner"],
                descriptions: [
                    "Victor's estranged daughter who recently reconciled. Runs a small biotechnology startup.",
                    "Elena's ambitious protege who was being groomed to take over the company."
                ],
                motives: [
                    "Stood to inherit $15 million but was recently cut from the will after a heated argument about her business failures.",
                    "Would lose her executive position after Elena discovered she was leaking company secrets to competitors."
                ],
                alibis: [
                    "I was at the Central Library from 7 PM to 10 PM researching for my startup. I checked out a book on pharmaceutical innovations around 8:30 PM.",
                    "I was working late at the office until 11 PM preparing for the quarterly board meeting. Several colleagues saw me there."
                ],
                evidenceOptions: [
                    [
                        "Security footage shows her car entering the library parking lot at 6:55 PM but no footage of her inside",
                        "Phone records show her phone was in the library area until 8:40 PM, then no signal until 9:50 PM",
                        "Found in her bag: receipt for coffee purchased 2 blocks from victim's house at 8:15 PM"
                    ],
                    [
                        "Security badge logs show she entered the building at 9:45 PM but didn't exit until 11:15 PM",
                        "Computer activity logs show no work done between 10:15-10:45 PM",
                        "Elevator security footage shows her on the victim's floor at 10:20 PM"
                    ]
                ]
            },
            {
                name: "Zette",
                image: "images/zette.jpg",
                voice: {
                    // Mature, sophisticated female voice
                    rate: 0.88,
                    pitch: 1.08,
                    volume: 0.95,
                    lang: 'en-US',
                    gender: 'female'
                },
                relationships: ["Personal Assistant", "Executive Assistant"],
                descriptions: [
                    "Victor's efficient personal assistant of 8 years. Knew all his business and personal affairs.",
                    "Elena's executive assistant who handled her schedule and confidential documents."
                ],
                motives: [
                    "Was secretly embezzling small amounts for years. Victor had scheduled an audit for the following week.",
                    "Had been stealing company secrets and selling them to competitors. Elena was about to discover this."
                ],
                alibis: [
                    "I was working late at the office until 9:30 PM, then went straight home. I have emails sent during that time and my computer login records.",
                    "I was organizing files in the executive storage room from 8 PM to 10:30 PM. The cleaning staff saw me there."
                ],
                evidenceOptions: [
                    [
                        "Computer logs show her account was active but no keystroke activity between 8:40-9:15 PM",
                        "Neighbor reports seeing her car pull into her driveway at 9:55 PM - too soon if she left office at 9:30 PM",
                        "Security log shows her keycard used to access Victor's house at 8:50 PM"
                    ],
                    [
                        "Storage room security shows she entered at 8:05 PM but left at 8:25 PM, not 10:30 PM",
                        "Her personal laptop was accessing company servers remotely during the time of the murder",
                        "Security footage shows her on Elena's private elevator at 10:10 PM"
                    ]
                ]
            },
            {
                name: "MJ",
                image: "./images/492074316_3558328864301152_6631248952161447965_n.jpg",
                voice: {
                    // Elegant, confident female voice
                    rate: 0.92,
                    pitch: 1.12,
                    volume: 1.0,
                    lang: 'en-US',
                    gender: 'female'
                },
                relationships: ["Rival Businessman", "Competitor CEO"],
                descriptions: [
                    "Owner of a competing real estate firm. Had multiple legal disputes with Victor.",
                    "CEO of a rival tech company that was losing market share to Elena's firm."
                ],
                motives: [
                    "Victor was about to win a major contract that would have bankrupted MJ's company. Had threatened Victor publicly.",
                    "Elena's new product launch would have destroyed MJ's company's market position."
                ],
                alibis: [
                    "I was at the charity gala at the Metropolitan Hall all evening from 7 PM until midnight. Hundreds of people saw me there.",
                    "I was hosting a product launch event at our corporate headquarters from 7 PM to 11 PM. Many witnesses can confirm."
                ],
                evidenceOptions: [
                    [
                        "Event photos show him present at 7:30 PM and 11:00 PM but none between 8:45-10:15 PM",
                        "His driver confirmed dropping him off at 7 PM but wasn't scheduled to pick him up until 11:30 PM",
                        "Phone location data places him within half a mile of victim's house at 9:10 PM"
                    ],
                    [
                        "Product launch attendance records show he gave his speech at 7:45 PM then left the stage",
                        "Security footage shows him leaving through a back entrance at 8:50 PM",
                        "His car was spotted near Elena's apartment building at 10:05 PM"
                    ]
                ]
            },
            {
                name: "Kassandra",
                image: "./images/kassandra.jpeg",
                voice: {
                    // Smooth, melodic female voice
                    rate: 0.98,
                    pitch: 1.18,
                    volume: 0.92,
                    lang: 'en-US',
                    gender: 'female'
                },
                relationships: ["Neighbor", "Business Rival"],
                descriptions: [
                    "Victor's next-door neighbor who had ongoing property disputes with him.",
                    "Elena's business school rival who was jealous of her success."
                ],
                motives: [
                    "Victor was blocking her plans to build an extension that would encroach on his property.",
                    "Was passed over for CEO position that went to Elena, destroying her career ambitions."
                ],
                alibis: [
                    "I was visiting my sister across town from 6 PM until after 11 PM. We had dinner and watched TV.",
                    "I was at a yoga retreat all evening from 6 PM to 10 PM. The instructor and other participants can confirm."
                ],
                evidenceOptions: [
                    [
                        "Sister confirms the visit but recalls Kassandra leaving briefly around 8:30 PM for 'fresh air'",
                        "Home security camera shows movement in Kassandra's backyard at 9:05 PM",
                        "A distinctive earring matching Kassandra's was found near Victor's back door"
                    ],
                    [
                        "Yoga retreat sign-in sheet shows she left at 8:15 PM and didn't return",
                        "Her car was recorded entering Elena's building parking garage at 9:25 PM",
                        "Diary entries found describing her hatred for Elena and desire for revenge"
                    ]
                ]
            },
            
            // BOYS - Each with unique male voice
            {
                name: "Jay",
                image: "images/jayyy.jpg",
                voice: {
                    // Casual, friendly male voice
                    rate: 0.94,
                    pitch: 0.98,
                    volume: 1.0,
                    lang: 'en-US',
                    gender: 'male'
                },
                relationships: ["Business Rival", "Former Partner"],
                descriptions: [
                    "Former business partner who had a bitter falling out with Victor years ago.",
                    "Elena's former business partner who was forced out of the company."
                ],
                motives: [
                    "Victor's latest business venture would directly compete with Jay's struggling company.",
                    "Elena's success was a constant reminder of his failure. Wanted to destroy what he helped build."
                ],
                alibis: [
                    "I was at a business conference in the next city all day and stayed overnight at the conference hotel.",
                    "I was on a flight to Chicago that departed at 8 PM and didn't land until 11 PM. I have my boarding pass."
                ],
                evidenceOptions: [
                    [
                        "Hotel check-in records show he arrived at 6:15 PM but no keycard activity until 10:30 PM",
                        "Toll records show his car passing back into the city at 8:20 PM",
                        "Conference badge was not scanned at any sessions after 4 PM"
                    ],
                    [
                        "Flight records show he changed his reservation to a later flight at 6:45 PM",
                        "Airport security shows him leaving through a different terminal at 8:15 PM",
                        "His rental car was recorded entering Elena's building at 9:40 PM"
                    ]
                ]
            },
            {
                name: "Jomar",
                image: "images/joms.jpg",
                voice: {
                    // Deep, serious male voice
                    rate: 0.86,
                    pitch: 0.88,
                    volume: 1.0,
                    lang: 'en-US',
                    gender: 'male'
                },
                relationships: ["Nephew", "Personal Trainer"],
                descriptions: [
                    "Victor's nephew who recently moved in with him after financial troubles.",
                    "Elena's personal trainer who was having an affair with her."
                ],
                motives: [
                    "The primary beneficiary if Mikay was removed from the will. Was deeply in debt to dangerous loan sharks.",
                    "Elena was ending their affair and threatening to tell his wife, which would destroy his marriage."
                ],
                alibis: [
                    "I was at the fitness center from 7:30 PM to 10 PM. Did my regular workout routine - treadmill, weights, then sauna.",
                    "I was at my son's basketball game from 7 PM to 9:30 PM. Dozens of parents saw me there cheering."
                ],
                evidenceOptions: [
                    [
                        "Fitness center biometric records show he entered at 7:32 PM but exited at 8:05 PM",
                        "Security camera across from victim's house captured his distinct motorcycle at 8:50 PM",
                        "Found in his jacket: theater ticket stub for a show that started at 8 PM downtown"
                    ],
                    [
                        "Game footage shows empty seat where he claimed to be sitting during key periods",
                        "Stadium security shows him leaving through emergency exit at 8:15 PM",
                        "Text messages show him arranging to meet Elena at her apartment at 8:30 PM"
                    ]
                ]
            },
            {
                name: "Josh",
                image: "images/josh.jpg",
                voice: {
                    // Confident, professional male voice
                    rate: 0.92,
                    pitch: 0.95,
                    volume: 1.0,
                    lang: 'en-US',
                    gender: 'male'
                },
                relationships: ["Business Partner", "Junior Executive"],
                descriptions: [
                    "Victor's ambitious junior partner who handled the commercial property portfolio.",
                    "Elena's junior executive who was recently passed over for promotion."
                ],
                motives: [
                    "Was about to be forced out of the company after Victor discovered financial irregularities in Josh's accounts.",
                    "Discovered Elena was planning to demote him after finding evidence of embezzlement."
                ],
                alibis: [
                    "I was at a late business dinner with clients at The Grand Hotel from 8 PM to 11 PM. We discussed the new waterfront development project.",
                    "I was working from home all evening, participating in a video conference with international colleagues from 9 PM to midnight."
                ],
                evidenceOptions: [
                    [
                        "Hotel reservation shows his name for 8 PM but no record of actual arrival",
                        "Credit card shows payment at a gas station 5 miles from victim's house at 9:05 PM",
                        "Text message to wife at 9:30 PM mentioned 'stuck in traffic near Oak Street'"
                    ],
                    [
                        "Home security system shows him leaving at 9:15 PM and returning at 11:05 PM",
                        "Video conference participants confirm he left abruptly at 9:40 PM and didn't return",
                        "Phone records show calls made from near Elena's apartment building"
                    ]
                ]
            },
            {
                name: "Louis",
                image: "images/louis.jpg",
                voice: {
                    // Authoritative, professional male voice
                    rate: 0.87,
                    pitch: 0.92,
                    volume: 1.0,
                    lang: 'en-US',
                    gender: 'male'
                },
                relationships: ["Family Lawyer", "Corporate Lawyer"],
                descriptions: [
                    "Victor's lawyer who handled his will and estate planning for over 20 years.",
                    "Elena's corporate lawyer who handled her company's legal affairs."
                ],
                motives: [
                    "Was named as executor with a substantial fee, but Victor was planning to change law firms.",
                    "Was overbilling Elena's company by millions and she was about to discover the fraud."
                ],
                alibis: [
                    "I was at home with my family all evening. We watched a movie together from 8 PM to 10 PM.",
                    "I was reviewing legal documents in my home office from 8 PM to 11 PM. My wife can confirm."
                ],
                evidenceOptions: [
                    [
                        "Streaming service shows the movie was paused at 8:42 PM and not resumed until 9:28 PM",
                        "Home security system logged the front door opening at 8:50 PM and closing at 9:20 PM",
                        "Cell tower data shows his phone connected to a tower near Victor's house at 9:05 PM"
                    ],
                    [
                        "Home office computer shows no activity between 9:15-10:05 PM",
                        "His car was seen entering Elena's building garage at 9:50 PM",
                        "Financial records show large transfers to his account from Elena's company"
                    ]
                ]
            }
        ];

        // Game variables
        let currentScenario;
        let killerIndex;
        let killer;
        let currentSuspect = null;
        let usedScenarios = [];

        // DOM elements
        const introElement = document.getElementById('intro');
        const suspectListElement = document.getElementById('suspect-list');
        const mainPanelElement = document.getElementById('main-panel');
        const resultElement = document.getElementById('result');
        const accusedTitleElement = document.getElementById('accused-title');
        const verdictElement = document.getElementById('verdict');
        const analysisElement = document.getElementById('analysis');
        const killerRevealTitleElement = document.getElementById('killer-reveal-title');
        const killerRevealElement = document.getElementById('killer-reveal');
        const playAgainButton = document.getElementById('play-again');
        const nextCaseButton = document.getElementById('next-case');
        const casesSolvedElement = document.getElementById('cases-solved');
        const accuracyElement = document.getElementById('accuracy');
        const currentStreakElement = document.getElementById('current-streak');
        const detectiveNotesElement = document.getElementById('detective-notes');

        // Get a random scenario that hasn't been used recently
        function getRandomScenario() {
            if (usedScenarios.length >= scenarios.length) {
                usedScenarios = [];
            }
            
            let availableScenarios = scenarios.filter(scenario => !usedScenarios.includes(scenario.id));
            const randomScenario = availableScenarios[Math.floor(Math.random() * availableScenarios.length)];
            usedScenarios.push(randomScenario.id);
            return randomScenario;
        }

        // Enhanced speech synthesis with natural voices
        function speakAlibi(text, voiceConfig, speakerElement) {
            const loadingElement = speakerElement.nextElementSibling;
            if (loadingElement && loadingElement.classList.contains('voice-loading')) {
                loadingElement.style.display = 'inline';
            }
            
            const utterance = new SpeechSynthesisUtterance(text);
            
            utterance.rate = voiceConfig.rate;
            utterance.pitch = voiceConfig.pitch;
            utterance.volume = voiceConfig.volume;
            utterance.lang = voiceConfig.lang;
            
            const voices = speechSynthesis.getVoices();
            let selectedVoice = null;
            
            // Try to find a voice that matches the gender preference
            if (voiceConfig.gender) {
                selectedVoice = voices.find(voice => {
                    // Check if voice name contains gender indicator
                    const voiceName = voice.name.toLowerCase();
                    return voiceName.includes(voiceConfig.gender) || 
                           (voiceConfig.gender === 'female' && 
                            (voiceName.includes('samantha') || voiceName.includes('karen') || 
                             voiceName.includes('victoria') || voiceName.includes('serena'))) ||
                           (voiceConfig.gender === 'male' && 
                            (voiceName.includes('alex') || voiceName.includes('daniel') || 
                             voiceName.includes('fred') || voiceName.includes('thomas')));
                });
            }
            
            // If no specific voice found, try to find any voice with appropriate gender
            if (!selectedVoice) {
                if (voiceConfig.gender === 'female') {
                    selectedVoice = voices.find(voice => 
                        voice.name.toLowerCase().includes('female') || 
                        voice.name.includes('Samantha') ||
                        voice.name.includes('Karen') ||
                        voice.name.includes('Victoria')
                    );
                } else if (voiceConfig.gender === 'male') {
                    selectedVoice = voices.find(voice => 
                        voice.name.toLowerCase().includes('male') ||
                        voice.name.includes('Alex') ||
                        voice.name.includes('Daniel')
                    );
                }
            }
            
            // If still no voice found, use the first available voice
            if (!selectedVoice && voices.length > 0) {
                selectedVoice = voices[0];
            }
            
            if (selectedVoice) {
                utterance.voice = selectedVoice;
            }
            
            utterance.onstart = () => {
                if (loadingElement) loadingElement.style.display = 'none';
                speakerElement.style.color = 'var(--success)';
            };
            
            utterance.onend = () => {
                speakerElement.style.color = 'var(--accent)';
            };
            
            utterance.onerror = () => {
                if (loadingElement) loadingElement.style.display = 'none';
                speakerElement.style.color = 'var(--accent)';
            };
            
            speechSynthesis.speak(utterance);
        }

        // Initialize game
        function initGame() {
            currentScenario = getRandomScenario();
            killerIndex = Math.floor(Math.random() * suspectsData.length);
            killer = suspectsData[killerIndex].name;
            
            const scenarioIndex = currentScenario.id - 1;
            const currentSuspectsData = suspectsData.map(suspect => {
                return {
                    name: suspect.name,
                    image: suspect.image,
                    voice: suspect.voice,
                    relationship: suspect.relationships[scenarioIndex],
                    description: suspect.descriptions[scenarioIndex],
                    motive: suspect.motives[scenarioIndex],
                    alibi: suspect.alibis[scenarioIndex],
                    evidence: suspect.evidenceOptions[scenarioIndex]
                };
            });

            introElement.innerHTML = `
                <h2>Case File: ${currentScenario.title}</h2>
                <p>${currentScenario.intro}</p>
                <div class="case-details">
                    <div class="case-detail-item">
                        <div class="case-detail-label">Victim</div>
                        <div class="case-detail-value">${currentScenario.victim}</div>
                    </div>
                    <div class="case-detail-item">
                        <div class="case-detail-label">Cause of Death</div>
                        <div class="case-detail-value">${currentScenario.causeOfDeath}</div>
                    </div>
                    <div class="case-detail-item">
                        <div class="case-detail-label">Time of Death</div>
                        <div class="case-detail-value">${currentScenario.timeOfDeath}</div>
                    </div>
                    <div class="case-detail-item">
                        <div class="case-detail-label">Crime Scene</div>
                        <div class="case-detail-value">${currentScenario.crimeScene}</div>
                    </div>
                </div>
            `;

            suspectListElement.innerHTML = '';
            currentSuspectsData.forEach((suspect, index) => {
                const li = document.createElement('li');
                li.className = 'suspect-item';
                li.innerHTML = `
                    <img src="${suspect.image}" alt="${suspect.name}">
                    <div class="suspect-info">
                        <div class="suspect-name">${suspect.name}</div>
                        <div class="suspect-relationship">${suspect.relationship}</div>
                    </div>
                `;
                li.addEventListener('click', () => showSuspectDetails(suspect, index));
                suspectListElement.appendChild(li);
            });

            mainPanelElement.innerHTML = `
                <div class="suspect-details">
                    <div class="suspect-header">
                        <img src="https://images.unsplash.com/photo-1560250097-0b93528c311a?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80" alt="Select a suspect" class="suspect-portrait">
                        <div class="suspect-bio">
                            <h2 class="suspect-name-large">Select a Suspect</h2>
                            <p class="suspect-description">Click on a suspect from the list to investigate their background, motive, alibi, and evidence. Analyze all information carefully before making an accusation. Look for contradictions between their alibi and the evidence.</p>
                        </div>
                    </div>
                </div>
            `;

            detectiveNotesElement.value = '';
            resultElement.style.display = 'none';
            playAgainButton.style.display = 'none';
            nextCaseButton.style.display = 'none';
            updateStats();
        }

        // Show suspect details
        function showSuspectDetails(suspect, index) {
            document.querySelectorAll('.suspect-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const clickedItem = Array.from(document.querySelectorAll('.suspect-item'))[index];
            if (clickedItem) {
                clickedItem.classList.add('active');
            }

            currentSuspect = suspect;
            
            mainPanelElement.innerHTML = `
                <div class="suspect-details fade-in">
                    <div class="suspect-header">
                        <img src="${suspect.image}" alt="${suspect.name}" class="suspect-portrait">
                        <div class="suspect-bio">
                            <h2 class="suspect-name-large">${suspect.name}</h2>
                            <p class="suspect-description">${suspect.relationship} of the victim. ${suspect.description}</p>
                        </div>
                    </div>
                    
                    <div class="motive-section">
                        <div class="section-title">
                            <span>üí∞</span> Potential Motive
                        </div>
                        <p class="motive-text">${suspect.motive}</p>
                    </div>
                    
                    <div class="alibi-section">
                        <div class="section-title">
                            <span>üìù</span> Alibi Statement
                            <span class="speaker" onclick="window.speakCurrentAlibi(this)">üîä</span>
                            <span class="voice-loading">Loading voice...</span>
                        </div>
                        <p class="alibi-text">${suspect.alibi}</p>
                    </div>
                    
                    <div class="evidence-section">
                        <div class="section-title">
                            <span>üîé</span> Collected Evidence
                        </div>
                        <ul class="evidence-list">
                            ${suspect.evidence.map(evidence => `<li class="evidence-item">${evidence}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="accuse" onclick="accuse('${suspect.name}')">
                            <span>‚öñÔ∏è</span> Accuse ${suspect.name}
                        </button>
                    </div>
                </div>
            `;
            
            window.currentSuspectForVoice = suspect;
        }

        // Global function for speaking current alibi
        window.speakCurrentAlibi = function(speakerElement) {
            if (window.currentSuspectForVoice) {
                speakAlibi(window.currentSuspectForVoice.alibi, window.currentSuspectForVoice.voice, speakerElement);
            }
        };

        // Accuse suspect
        function accuse(name) {
            gameState.casesPlayed++;
            
            const isCorrect = name === killer;
            
            if (isCorrect) {
                gameState.casesSolved++;
                gameState.currentStreak++;
                if (gameState.currentStreak > gameState.bestStreak) {
                    gameState.bestStreak = gameState.currentStreak;
                }
            } else {
                gameState.currentStreak = 0;
            }
            
            localStorage.setItem('casesSolved', gameState.casesSolved);
            localStorage.setItem('casesPlayed', gameState.casesPlayed);
            localStorage.setItem('currentStreak', gameState.currentStreak);
            localStorage.setItem('bestStreak', gameState.bestStreak);
            
            updateStats();
            
            accusedTitleElement.textContent = `Investigation Result: ${isCorrect ? 'Case Solved!' : 'Wrong Accusation'}`;
            
            if (isCorrect) {
                verdictElement.className = 'verdict correct';
                verdictElement.innerHTML = `
                    <h3 style="color: var(--success); margin-bottom: 10px;">‚úÖ Brilliant Deduction, Detective Abby!</h3>
                    <p>You successfully identified ${killer} as the killer. Your attention to detail and logical reasoning solved the case!</p>
                `;
            } else {
                verdictElement.className = 'verdict incorrect';
                verdictElement.innerHTML = `
                    <h3 style="color: var(--danger); margin-bottom: 10px;">‚ùå Incorrect Accusation</h3>
                    <p>${name} is not the killer. Further investigation cleared them of suspicion.</p>
                `;
            }
            
            analysisElement.innerHTML = `
                <h3>Investigation Analysis</h3>
                <p>The key contradiction was in <span class="clue-highlight">${killer}'s alibi</span>:</p>
                <p>${currentScenario.killerReveals[killerIndex]}</p>
            `;
            
            killerRevealTitleElement.textContent = "The Real Killer";
            killerRevealElement.textContent = `${killer}! ${currentScenario.killerReveals[killerIndex]}`;
            
            resultElement.style.display = 'block';
            playAgainButton.style.display = 'inline-flex';
            nextCaseButton.style.display = 'inline-flex';
            
            resultElement.scrollIntoView({ behavior: 'smooth' });
        }

        // Update game statistics
        function updateStats() {
            casesSolvedElement.textContent = gameState.casesSolved;
            currentStreakElement.textContent = gameState.currentStreak;
            
            const accuracy = gameState.casesPlayed > 0 
                ? Math.round((gameState.casesSolved / gameState.casesPlayed) * 100) 
                : 0;
            accuracyElement.textContent = `${accuracy}%`;
        }

        // Event listeners
        playAgainButton.addEventListener('click', () => {
            initGame();
        });

        nextCaseButton.addEventListener('click', () => {
            initGame();
        });

        // Load voices and initialize game
        window.addEventListener('load', () => {
            let voices = [];
            speechSynthesis.onvoiceschanged = () => {
                voices = speechSynthesis.getVoices();
            };
            
            initGame();
        });
    </script>
</body>
</html>